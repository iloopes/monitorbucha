<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Bucha Virtual - Controle</title>
    <link rel="stylesheet" href="/static/style.css?v=2.1">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîå Sistema de Bucha Virtual</h1>
            <p class="subtitle">Gera√ß√£o e Controle de Dados Sint√©ticos + Otimiza√ß√£o por Ativo (Markov + NSGA-II)</p>
        </header>

        <!-- Status da API -->
        <div class="card status-card">
            <h2>Status do Sistema</h2>
            <div id="api-status" class="status-info">
                <span class="status-indicator" id="status-dot"></span>
                <span id="status-text">Verificando...</span>
            </div>
        </div>

        <!-- Configura√ß√£o do Banco de Dados -->
        <div class="card">
            <h2>‚öôÔ∏è Configura√ß√£o do Banco de Dados</h2>
            <form id="db-config-form">
                <div class="form-group">
                    <label for="server">Servidor SQL Server:</label>
                    <input type="text" id="server" name="server" value="DESKTOP-0L1FQAQ\KUZUSHI" required>
                </div>

                <div class="form-group">
                    <label for="database">Nome do Banco:</label>
                    <input type="text" id="database" name="database" value="MaintenanceDB" required>
                </div>

                <div class="form-group checkbox-group">
                    <input type="checkbox" id="trusted-connection" name="trusted_connection" checked>
                    <label for="trusted-connection">Autentica√ß√£o Windows (Trusted Connection)</label>
                </div>

                <div id="credentials" style="display: none;">
                    <div class="form-group">
                        <label for="username">Usu√°rio:</label>
                        <input type="text" id="username" name="username">
                    </div>

                    <div class="form-group">
                        <label for="password">Senha:</label>
                        <input type="password" id="password" name="password">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">Conectar ao Banco</button>
                <button type="button" id="init-db-btn" class="btn btn-secondary">Criar Tabelas</button>
            </form>
            <div id="db-status" class="result-message"></div>
        </div>

        <!-- Gera√ß√£o de Dados -->
        <div class="card">
            <h2>üìä Gerar Dados Sint√©ticos</h2>
            <form id="generate-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="n-bushings">N√∫mero de Buchas:</label>
                        <input type="number" id="n-bushings" name="n_bushings" value="10" min="1" max="100" required>
                    </div>

                    <div class="form-group">
                        <label for="days">Per√≠odo (dias):</label>
                        <input type="number" id="days" name="days" value="30" min="1" max="365" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="frequency">Frequ√™ncia (horas):</label>
                        <input type="number" id="frequency" name="frequency_hours" value="1" min="1" max="24" required>
                    </div>

                    <div class="form-group">
                        <label for="degradation-rate">Taxa de Degrada√ß√£o:</label>
                        <select id="degradation-rate" name="degradation_rate">
                            <option value="low">Baixa</option>
                            <option value="medium" selected>M√©dia</option>
                            <option value="high">Alta</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="scenario-name">Nome do Cen√°rio (opcional):</label>
                    <input type="text" id="scenario-name" name="scenario_name" placeholder="Ex: cenario_teste_01">
                </div>

                <div class="form-group checkbox-group">
                    <input type="checkbox" id="save-db" name="save_to_database" checked>
                    <label for="save-db">Salvar no Banco de Dados</label>
                </div>

                <button type="submit" class="btn btn-success btn-large">üöÄ Gerar Dados</button>
            </form>
            <div id="generate-status" class="result-message"></div>
        </div>

        <!-- Resultados -->
        <div class="card" id="results-card" style="display: none;">
            <h2>‚úÖ Resultados da Gera√ß√£o</h2>
            <div id="results-content"></div>
        </div>

        <!-- Otimiza√ß√£o de Manuten√ß√£o -->
        <div class="card">
            <h2>üéØ Otimiza√ß√£o de Manuten√ß√£o (Markov + NSGA-II)</h2>
            <p class="subtitle">Execute os algoritmos de otimiza√ß√£o para gerar o calend√°rio de manuten√ß√£o</p>

            <form id="optimize-form">
                <div class="form-group">
                    <label for="equipment-select">üìã Selecionar Equipamento(s):</label>
                    <select id="equipment-select" name="equipment_select" class="equipment-select">
                        <option value="all">üîÑ Todos os Equipamentos</option>
                    </select>
                    <button type="button" class="btn btn-secondary" onclick="loadEquipmentList()" style="margin-top: 10px;">üîÑ Carregar Lista de Equipamentos</button>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="max-evaluations">M√°ximo de Avalia√ß√µes:</label>
                        <input type="number" id="max-evaluations" name="max_evaluations" value="4000" min="1000" max="10000" required>
                    </div>

                    <div class="form-group">
                        <label for="population-size">Tamanho da Popula√ß√£o:</label>
                        <input type="number" id="population-size" name="population_size" value="200" min="50" max="500" required>
                    </div>
                </div>

                <div class="form-group checkbox-group">
                    <input type="checkbox" id="save-optimization" name="save_to_database" checked>
                    <label for="save-optimization">Salvar Resultados no Banco</label>
                </div>

                <button type="submit" class="btn btn-primary btn-large">‚ö° Executar Otimiza√ß√£o</button>
            </form>
            <div id="optimize-status" class="result-message"></div>
        </div>

        <!-- Calend√°rio de Manuten√ß√£o -->
        <div class="card" id="calendar-card">
            <h2>üìÖ Calend√°rio de Manuten√ß√£o</h2>
            <div class="form-row">
                <button class="btn btn-success" onclick="loadMaintenanceCalendar()">üîÑ Atualizar Calend√°rio</button>
            </div>
            <div id="calendar-content">
                <p class="info-text">Execute a otimiza√ß√£o primeiro para gerar o calend√°rio</p>
            </div>
        </div>

        <!-- Visualiza√ß√£o de Dados -->
        <div class="card">
            <h2>üìà Visualizar Dados</h2>
            <div class="form-row">
                <button class="btn btn-info" onclick="viewSensorData()">Ver Dados de Sensores</button>
                <button class="btn btn-info" onclick="viewMaintenanceOrders()">Ver Ordens de Servi√ßo</button>
                <button class="btn btn-info" onclick="viewParetoFront()">Ver Fronteira de Pareto</button>
            </div>
            <div id="view-results" class="data-view"></div>
        </div>
    </div>

    <footer>
        <p>Sistema de Manuten√ß√£o Preditiva v2.0 | ¬© 2025</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="/static/app.js?v=2.4"></script>
</body>
</html>
